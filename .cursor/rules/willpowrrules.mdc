---
description: Rules for building a scalable, premium, futuristic habit app with high performance and modern UI.
globs: ["**/*"]
alwaysApply: true
---

# ğŸ’ Million-Dollar SwiftUI App Rulebook

You're helping build a premium, scalable SwiftUI app that lets users **build or quit habits**. Every UI and logic decision must reflect polish, performance, and modern design â€” like an app made by a top-tier iOS product team.

---

## ğŸ§± Architecture & Folder Structure

- Use **Swift** with modern concurrency (async/await).
- Follow **MVVM** architecture pattern strictly.
- No business logic inside SwiftUI Views.
- State management with **@StateObject**, **@ObservedObject**, and **@EnvironmentObject**.
- Folder structure:

```
WillPowr/
â”œâ”€â”€ App/
â”‚   â”œâ”€â”€ WillPowrApp.swift
â”‚   â””â”€â”€ ContentView.swift
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ Home/
â”‚   â”œâ”€â”€ HabitTracker/
â”‚   â”œâ”€â”€ Settings/
â”‚   â””â”€â”€ Onboarding/
â”œâ”€â”€ ViewModels/
â”œâ”€â”€ Models/
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ HealthKitService.swift
â”‚   â”œâ”€â”€ NotificationService.swift
â”‚   â””â”€â”€ DataService.swift
â”œâ”€â”€ Extensions/
â”œâ”€â”€ Utilities/
â””â”€â”€ Resources/
```

---

## âœ¨ UI & UX Guidelines

- Design must feel **futuristic**, **polished**, and **premium**.
- Use **SwiftUI** native animations and transitions.
- Prefer glassmorphism, gradients, blur effects, soft shadows.
- Animate with **withAnimation()**, **@State**, and **AnimatableModifier**.
- Interactions should be smooth and snappy (60fps).
- Use **redacted(reason: .placeholder)** for loading states.
- Support **Dark Mode** and **Dynamic Type** always.
- Prioritize accessibility with **accessibilityLabel**, **accessibilityHint**.
- Add useful empty states, error messages, and smooth transitions.
- Use **SF Symbols** for consistent iconography.

---

## âœ… Habit Logic

### Add Habit Flow

1. User chooses: Build or Quit
2. Select preset or custom habit
3. Preset = preconfigured logic (e.g., steps = HealthKit, reading = timer)
4. If user denies permissions, fallback to simple checkmark button
5. Add habit card to dashboard with:
   - Type (Build/Quit)
   - Current streak
   - Completion method (auto or manual)
   - Widget-ready display

---

## ğŸ“± Smart Inputs by Habit Type

- **Run** â†’ HealthKit step/distance tracking
- **Walk** â†’ Step count from HealthKit
- **Gym** â†’ CoreLocation gym detection
- **Reading / Meditation** â†’ In-app timer with background support
- **Wake Up Early** â†’ Button appears only at selected time
- **Pushups / Water / Gratitude** â†’ Manual checkmark

### Quit Habits

- **Porn / Sugar / Vape / Social Media** â†’ "I Failed" button resets streak
- **Screen Time** â†’ Advanced (future) feature: ScreenTime API integration

---

## ğŸ§ª Performance Checklist

- Keep View updates minimal (proper **@State** usage).
- Use **LazyVStack/LazyHStack** for large lists.
- Optimize with **@ViewBuilder** and conditional rendering.
- Preload critical data on app launch.
- Optimize images with **AsyncImage** and caching.
- Target < 1s cold-start load time.
- Use **@MainActor** for UI updates.
- Avoid heavy computations in View body.

---

## ğŸ§¾ SwiftUI Code Quality Checklist

- âœ… **Type-safe everywhere** with proper Swift types
- âœ… **Clean reusable Views** (no massive view files)
- âœ… **ViewModels** for reusable logic and state
- âœ… **Proper state management** (@State, @StateObject, @ObservedObject)
- âœ… **PreviewProvider** for every View
- âœ… **Extension** usage for View modifiers
- âœ… **Dependency injection** via Environment

---

## ğŸ“ SwiftUI Best Practices

### View Organization

- Each SwiftUI View in its own file
- Max 200 lines per View file
- Use **@ViewBuilder** for complex layouts
- Extract subviews when > 50 lines

### State Management

- **@State** for local UI state
- **@StateObject** for view-owned objects
- **@ObservedObject** for injected objects
- **@EnvironmentObject** for app-wide state

### Naming Conventions

- `HabitTrackerView.swift`
- `HabitTrackerViewModel.swift`
- `HabitModel.swift`
- `HabitService.swift`

### Performance

- Use **LazyVStack** for long lists
- Implement **Equatable** for complex models
- Use **@ViewBuilder** to reduce View updates
- Cache expensive computations

---

## ğŸ” Security & Privacy

- Request **HealthKit** permissions gracefully
- Handle **Location** permissions properly
- Use **Keychain** for sensitive data
- Follow **App Store Review Guidelines**
- Implement proper **data encryption**

---

## ğŸ¯ Premium Features

- **Haptic feedback** for interactions
- **Widgets** for home screen
- **Shortcuts** integration
- **Apple Watch** companion app
- **iCloud** sync across devices
- **Premium animations** and transitions

- âœ… Error boundaries
- âœ… Snapshot/unit tests for every screen & core component
